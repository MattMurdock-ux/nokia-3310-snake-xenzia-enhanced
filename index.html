<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Xenzia - Nokia Style</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            font-family: 'Courier New', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #00ff41;
        }
        .nokia-phone {
            width: 340px; height: 580px;
            background: linear-gradient(145deg, #0f1419, #1e293b);
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.9);
            position: relative;
        }
        .screen {
            width: 100%; height: 75%;
            background: #0a0a0a;
            border: 5px solid #333;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            margin-bottom: 15px;
        }
        .game-area {
            width: 100%; height: 70%;
            display: grid;
            grid-template-columns: repeat(22, 1fr);
            grid-template-rows: repeat(28, 1fr);
            gap: 1px;
            padding: 12px;
            background: #001100;
            margin-bottom: 10px;
        }
        .cell {
            background: #004d00;
            border: 1px solid #003300;
        }
        .snake { background: #00ff41 !important; border-color: #00cc33 !important; }
        .food { background: #ffff00 !important; border-color: #cccc00 !important; box-shadow: 0 0 8px #ffff00; }
        .ui-panel {
            position: absolute; bottom: 15px; left: 15px; right: 15px;
            background: rgba(0,0,0,0.8); padding: 10px; border-radius: 8px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .score-level { font-size: 16px; font-weight: bold; }
        .level-btns button, .speed-btns button {
            background: #00ff41; color: #000; border: none;
            padding: 8px 12px; border-radius: 5px; font-weight: bold;
            cursor: pointer; font-size: 14px; margin: 0 2px;
        }
        .speed-btns button { background: #444; color: #00ff41; }
        .game-over {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center; color: #ff4444;
            font-size: 28px; font-weight: bold; text-shadow: 0 0 15px #ff4444;
            display: none; z-index: 10;
        }
        .logo {
            position: absolute; top: 8px; right: 15px;
            font-size: 16px; color: #666; font-weight: bold;
        }
        .restart-btn {
            background: #ff4444; color: white; border: none;
            padding: 12px 24px; border-radius: 8px; font-size: 18px;
            cursor: pointer; margin-top: 15px; font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="nokia-phone">
        <div class="logo">NOKIA</div>
        <div class="screen">
            <div class="game-area" id="gameArea"></div>
            <div class="ui-panel">
                <div class="score-level">
                    <div>SCORE: <span id="score">0</span></div>
                    <div>LEVEL: <span id="level">Easy</span> (Speed: <span id="speed">150</span>ms)</div>
                </div>
                <div class="level-btns">
                    <button onclick="game.setLevel('easy')">Easy</button>
                    <button onclick="game.setLevel('medium')">Med</button>
                    <button onclick="game.setLevel('hard')">Hard</button>
                </div>
                <div class="speed-btns">
                    <button onclick="game.changeSpeed(-25)">-</button>
                    <button onclick="game.changeSpeed(25)">+</button>
                </div>
            </div>
            <div class="game-over" id="gameOver">
                GAME OVER!<br>
                Final Score: <span id="finalScore">0</span><br>
                <button class="restart-btn" onclick="game.restart()">PLAY AGAIN</button>
            </div>
        </div>
    </div>

    <script>
        class SnakeGame {
            constructor() {
                this.gridSize = 22;
                this.gridHeight = 28;
                this.snake = [{x: 11, y: 14}];
                this.direction = {x: 1, y: 0};
                this.food = {};
                this.score = 0;
                this.gameSpeed = 150; // Easy: 150ms, Medium: 100ms, Hard: 75ms
                this.gameRunning = true;
                this.currentLevel = 'easy';
                this.gameArea = document.getElementById('gameArea');
                this.scoreEl = document.getElementById('score');
                this.levelEl = document.getElementById('level');
                this.speedEl = document.getElementById('speed');
                this.gameOverEl = document.getElementById('gameOver');
                this.finalScoreEl = document.getElementById('finalScore');
                this.init();
            }

            init() {
                this.createGrid();
                this.placeFood();
                this.gameLoop();
                this.bindControls();
                this.updateUI();
            }

            createGrid() {
                this.gameArea.innerHTML = '';
                for(let y = 0; y < this.gridHeight; y++) {
                    for(let x = 0; x < this.gridSize; x++) {
                        const cell = document.createElement('div');
                        cell.className = 'cell';
                        cell.dataset.x = x;
                        cell.dataset.y = y;
                        this.gameArea.appendChild(cell);
                    }
                }
            }

            setLevel(level) {
                this.currentLevel = level;
                switch(level) {
                    case 'easy': this.gameSpeed = 150; break;
                    case 'medium': this.gameSpeed = 100; break;
                    case 'hard': this.gameSpeed = 75; break;
                }
                this.updateUI();
            }

            changeSpeed(delta) {
                this.gameSpeed = Math.max(50, Math.min(200, this.gameSpeed + delta));
                this.updateUI();
            }

            updateUI() {
                this.levelEl.textContent = this.currentLevel.charAt(0).toUpperCase() + this.currentLevel.slice(1);
                this.speedEl.textContent = this.gameSpeed;
            }

            placeFood() {
                do {
                    this.food = {
                        x: Math.floor(Math.random() * this.gridSize),
                        y: Math.floor(Math.random() * this.gridHeight)
                    };
                } while(this.isSnakeOnPosition(this.food.x, this.food.y));
                this.updateCell(this.food.x, this.food.y, 'food');
            }

            gameLoop() {
                if(!this.gameRunning) return;
                setTimeout(() => {
                    this.update();
                    this.gameLoop();
                }, this.gameSpeed);
            }

            update() {
                const head = {x: this.snake[0].x + this.direction.x, 
                             y: this.snake[0].y + this.direction.y};

                if(head.x < 0 || head.x >= this.gridSize || head.y < 0 || head.y >= this.gridHeight) {
                    this.gameOver();
                    return;
                }

                if(this.isSnakeOnPosition(head.x, head.y)) {
                    this.gameOver();
                    return;
                }

                this.snake.unshift(head);

                if(head.x === this.food.x && head.y === this.food.y) {
                    this.score += 10;
                    this.scoreEl.textContent = this.score;
                    this.placeFood();
                } else {
                    const tail = this.snake.pop();
                    this.updateCell(tail.x, tail.y, '');
                }

                this.updateCell(head.x, head.y, 'snake');
            }

            isSnakeOnPosition(x, y) {
                return this.snake.some(segment => segment.x === x && segment.y === y);
            }

            updateCell(x, y, className) {
                const cell = this.gameArea.querySelector(`[data-x="${x}"][data-y="${y}"]`);
                if(cell) cell.className = className ? `cell ${className}` : 'cell';
            }

            changeDirection(newDir) {
                // Prevent reverse direction
                if((newDir.x * -1 === this.direction.x && newDir.y * -1 === this.direction.y)) {
                    return;
                }
                this.direction = newDir;
            }

            bindControls() {
                // Keyboard
                document.addEventListener('keydown', (e) => {
                    e.preventDefault();
                    switch(e.key) {
                        case 'ArrowUp': this.changeDirection({x: 0, y: -1}); break;
                        case 'ArrowDown': this.changeDirection({x: 0, y: 1}); break;
                        case 'ArrowLeft': this.changeDirection({x: -1, y: 0}); break;
                        case 'ArrowRight': this.changeDirection({x: 1, y: 0}); break;
                    }
                });

                // Touch swipe (fixed)
                let startX, startY;
                document.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                }, {passive: true});
                
                document.addEventListener('touchend', (e) => {
                    if(!startX || !startY) return;
                    const endX = e.changedTouches[0].clientX;
                    const endY = e.changedTouches[0].clientY;
                    const diffX = startX - endX;
                    const diffY = startY - endY;

                    if(Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                        if(diffX > 0) this.changeDirection({x: -1, y: 0}); // Left
                        else this.changeDirection({x: 1, y: 0}); // Right
                    } else if(Math.abs(diffY) > 30) {
                        if(diffY > 0) this.changeDirection({x: 0, y: -1}); // Up
                        else this.changeDirection({x: 0, y: 1}); // Down
                    }
                    startX = startY = null;
                }, {passive: true});
            }

            gameOver() {
                this.gameRunning = false;
                this.finalScoreEl.textContent = this.score;
                this.gameOverEl.style.display = 'block';
            }

            restart() {
                this.snake = [{x: 11, y: 14}];
                this.direction = {x: 1, y: 0};
                this.score = 0;
                this.gameRunning = true;
                this.scoreEl.textContent = '0';
                this.gameOverEl.style.display = 'none';
                this.createGrid();
                this.placeFood();
                this.gameLoop();
            }
        }

        let game;
        window.addEventListener('load', () => {
            game = new SnakeGame();
        });
    </script>
</body>
</html>
