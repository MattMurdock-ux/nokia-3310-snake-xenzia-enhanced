<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Xenzia - Nokia 3310 Joystick</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(145deg, #1a1a2e, #16213e);
            font-family: 'Courier New', monospace;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; color: #00ff41; touch-action: manipulation;
        }
        .nokia-phone {
            width: 360px; height: 620px; background: linear-gradient(145deg, #0f1419, #1e293b);
            border-radius: 30px; padding: 25px; box-shadow: 0 30px 60px rgba(0,0,0,0.9);
            position: relative;
        }
        .screen { 
            width: 100%; height: 85%; background: #0a0a0a; border: 6px solid #333;
            border-radius: 20px; position: relative; overflow: hidden;
        }
        
        /* CORNER PANELS - NO OVERLAP */
        .top-left-panel {
            position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.9);
            padding: 12px; border-radius: 12px; border: 2px solid #ffff00; min-width: 90px;
        }
        .top-right-panel {
            position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.9);
            padding: 12px; border-radius: 12px; border: 2px solid #00ff41; min-width: 90px;
        }
        
        /* SPEED PANEL - TOP RIGHT */
        .speed-panel { text-align: center; }
        .speed-controls button {
            width: 35px; height: 35px; border-radius: 50%; border: 2px solid #00ff41;
            background: rgba(0,0,0,0.7); color: #00ff41; margin: 2px; font-weight: bold;
            cursor: pointer;
        }
        
        /* LEADERBOARD - TOP LEFT */
        .leaderboard { max-height: 180px; overflow-y: auto; font-size: 12px; }
        .leader-item { margin: 2px 0; color: #ffff00; }
        .leader-you { color: #00ff41 !important; font-weight: bold; }
        
        /* FULL SCREEN GAME AREA */
        .game-area {
            position: absolute; top: 90px; left: 15px; right: 15px; bottom: 120px;
            display: grid; grid-template-columns: repeat(24, 1fr); grid-template-rows: repeat(30, 1fr);
            gap: 1px; padding: 10px; background: #001100;
        }
        .cell { background: #004d00; border: 1px solid #003300; }
        .snake { background: #00ff41 !important; border-color: #00cc33 !important; }
        .food { background: #ffff00 !important; border-color: #cccc00 !important; box-shadow: 0 0 10px #ffff00; }
        
        /* CIRCULAR JOYSTICK - BOTTOM CENTER */
        .joystick-container {
            position: absolute; bottom: 25px; left: 50%; transform: translateX(-50%);
            width: 220px; height: 220px; display: flex; align-items: center; justify-content: center;
        }
        .joystick-ring {
            width: 200px; height: 200px; border: 6px solid #00ff41; border-radius: 50%;
            position: relative; background: rgba(0,77,0,0.3);
            box-shadow: 0 0 30px rgba(0,255,65,0.4);
        }
        .joystick-left { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); }
        .joystick-right { position: absolute; right: 20px; top: 50%; transform: translateY(-50%); }
        .joystick-up { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); }
        .joystick-down { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); }
        .joystick-pause { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        
        .joy-btn {
            width: 65px; height: 65px; border-radius: 50%; border: 5px solid #00ff41;
            background: linear-gradient(145deg, #004d00, #006600); color: #00ff41;
            font-size: 26px; font-weight: bold; cursor: pointer; user-select: none;
            display: flex; align-items: center; justify-content: center;
            transition: all 0.15s; box-shadow: 0 10px 25px rgba(0,255,65,0.3);
            touch-action: manipulation;
        }
        .joy-btn:active {
            transform: scale(0.92); box-shadow: 0 5px 15px rgba(0,255,65,0.2);
            background: linear-gradient(145deg, #003300, #005500);
        }
        .pause-btn { 
            background: linear-gradient(145deg, #ff4444, #cc3333) !important; 
            border-color: #ff6666 !important; color: white !important; font-size: 22px;
        }
        
        .logo { position: absolute; top: 8px; right: 20px; font-size: 18px; color: #666; font-weight: bold; z-index: 20; }
        .game-over {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; color: #ff4444; font-size: 32px; font-weight: bold;
            text-shadow: 0 0 20px #ff4444; display: none; z-index: 20;
            background: rgba(0,0,0,0.95); padding: 35px; border-radius: 25px;
            border: 4px solid #ff4444; min-width: 250px;
        }
    </style>
</head>
<body>
    <div class="nokia-phone">
        <div class="logo">NOKIA 3310</div>
        <div class="screen">
            <!-- SPEED PANEL - TOP RIGHT CORNER -->
            <div class="top-right-panel speed-panel">
                <div style="font-weight:bold;">‚ö° SPEED</div>
                <div style="font-size:14px;margin:5px 0;">Level: <span id="level">Easy</span></div>
                <div style="font-size:14px;">Speed: <span id="speed">150</span>ms</div>
                <div class="speed-controls" style="margin-top:8px;">
                    <button onclick="game.changeSpeed(-25)">-</button>
                    <span id="speedVal">150</span>
                    <button onclick="game.changeSpeed(25)">+</button>
                </div>
            </div>
            
            <!-- LEADERBOARD - TOP LEFT CORNER -->
            <div class="top-left-panel leaderboard">
                <div style="font-weight:bold;color:#ffff00;">üèÜ TOP 5</div>
                <div id="leaderList"></div>
            </div>
            
            <!-- FULL GAME AREA -->
            <div class="game-area" id="gameArea"></div>
            
            <!-- GAME OVER MODAL -->
            <div class="game-over" id="gameOver">
                GAME OVER!<br>
                <div style="font-size:20px;margin:15px 0;">Final: <span id="finalScore">0</span></div>
                <button class="joy-btn pause-btn" onclick="game.restart()" style="width:140px;font-size:20px;">PLAY AGAIN</button>
            </div>
        </div>
        
        <!-- CIRCULAR JOYSTICK -->
        <div class="joystick-container">
            <div class="joystick-ring">
                <div class="joy-btn joystick-left" ontouchstart="game.changeDirection({x:-1,y:0})" onmousedown="game.changeDirection({x:-1,y:0})">‚óÄ</div>
                <div class="joy-btn joystick-up" ontouchstart="game.changeDirection({x:0,y:-1})" onmousedown="game.changeDirection({x:0,y:-1})">‚ñ≤</div>
                <div class="joy-btn joystick-down" ontouchstart="game.changeDirection({x:0,y:1})" onmousedown="game.changeDirection({x:0,y:1})">‚ñº</div>
                <div class="joy-btn joystick-right" ontouchstart="game.changeDirection({x:1,y:0})" onmousedown="game.changeDirection({x:1,y:0})">‚ñ∂</div>
                <div class="joy-btn pause-btn joystick-pause" onclick="game.togglePause()">‚è∏</div>
            </div>
        </div>
    </div>

    <script>
        class SnakeGame {
            constructor() {
                this.gridSize = 24; this.gridHeight = 30;
                this.snake = [{x: 12, y: 15}]; this.direction = {x: 1, y: 0};
                this.food = {}; this.score = 0; this.gameSpeed = 150;
                this.gameRunning = true; this.paused = false; this.currentLevel = 'easy';
                this.leaderboard = JSON.parse(localStorage.getItem('snakeLeaderboard') || '[]');
                this.initElements(); this.init();
            }

            initElements() {
                this.gameArea = document.getElementById('gameArea');
                this.scoreEl = document.getElementById('score');
                this.levelEl = document.getElementById('level');
                this.speedEl = document.getElementById('speed');
                this.speedValEl = document.getElementById('speedVal');
                this.gameOverEl = document.getElementById('gameOver');
                this.finalScoreEl = document.getElementById('finalScore');
                this.leaderboardEl = document.getElementById('leaderList');
            }

            init() {
                this.createGrid(); this.placeFood(); this.gameLoop(); this.bindControls();
                this.updateUI(); this.updateLeaderboard();
            }

            togglePause() {
                this.paused = !this.paused;
                if(!this.paused) this.gameLoop();
            }

            // ... [rest of game logic same as previous version - createGrid, update, etc.]
            createGrid() {
                this.gameArea.innerHTML = '';
                for(let y = 0; y < this.gridHeight; y++) {
                    for(let x = 0; x < this.gridSize; x++) {
                        const cell = document.createElement('div');
                        cell.className = 'cell'; cell.dataset.x = x; cell.dataset.y = y;
                        this.gameArea.appendChild(cell);
                    }
                }
            }

            setLevel(level) {
                this.currentLevel = level;
                this.gameSpeed = {easy: 150, medium: 100, hard: 75}[level];
                this.updateUI();
            }

            changeSpeed(delta) {
                this.gameSpeed = Math.max(50, Math.min(250, this.gameSpeed + delta));
                this.updateUI();
            }

            updateUI() {
                this.levelEl.textContent = this.currentLevel.toUpperCase();
                this.speedEl.textContent = this.speedValEl.textContent = this.gameSpeed;
            }

            placeFood() {
                do {
                    this.food = {x: Math.floor(Math.random() * this.gridSize), y: Math.floor(Math.random() * this.gridHeight)};
                } while(this.isSnakeOnPosition(this.food.x, this.food.y));
                this.updateCell(this.food.x, this.food.y, 'food
